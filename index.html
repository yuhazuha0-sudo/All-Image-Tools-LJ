<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Primary Meta (preserved + improved) -->
  <title>All Image Tools ‚Äî Free Online Image Compressor & Toolkit</title>
  <meta name="description" content="All Image Tools: Free client-side image toolkit ‚Äî compress, convert, resize, crop, rotate, extract colors and more. Batch support, target KB/MB and privacy-first." />
  <meta name="keywords" content="image compressor, compress image online, reduce image size, photo compressor, batch image compressor, webp converter, jpg compressor, png compressor" />

  <!-- Google Verification (preserved) -->
  <meta name="google-site-verification" content="Qwac3UqKv3fpo4-b5ENzwdGoSKqIHasZwHz3ydy3Ong" />

  <!-- Canonical - change if you use a custom domain -->
  <link rel="canonical" href="https://yuhazuha0-sudo.github.io/All-Image-Tools/" />

  <!-- Open Graph -->
  <meta property="og:title" content="All Image Tools ‚Äî Free Online Image Toolkit" />
  <meta property="og:description" content="Compress, convert, resize, crop and process images entirely in your browser. Batch support, ZIP download, and privacy-first." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://yuhazuha0-sudo.github.io/All-Image-Tools/" />
  <meta property="og:image" content="https://yuhazuha0-sudo.github.io/All-Image-Tools/logo.png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="All Image Tools ‚Äî Free Online Image Toolkit" />
  <meta name="twitter:description" content="Compress, convert, resize, crop and process images entirely in your browser. Batch support, ZIP download, and privacy-first." />
  <meta name="twitter:image" content="https://yuhazuha0-sudo.github.io/All-Image-Tools/logo.png" />

  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üñºÔ∏è</text></svg>">

  <!-- JSON-LD WebSite (SEO helper) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "All Image Tools",
    "url": "https://yuhazuha0-sudo.github.io/All-Image-Tools/",
    "description": "Free client-side image toolkit: compress, convert, resize, crop and more.",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://yuhazuha0-sudo.github.io/All-Image-Tools/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>

  <!-- Critical CSS (inline for faster LCP) -->
  <style>
    :root{
      --accent:#0b5fff; --accent-2:#7aa8ff; --bg:#f6f8fb; --card:#ffffff; --muted:#6b7280; --radius:12px;
    }
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:#07102b;background:var(--bg);-webkit-font-smoothing:antialiased}
    .container{max-width:1100px;margin:20px auto;padding:16px}
    header{display:flex;align-items:center;gap:12px}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:white;font-weight:700}
    h1{font-size:18px;margin:0}
    .muted{color:var(--muted);font-size:13px}
    .card{background:var(--card);border-radius:var(--radius);padding:14px;box-shadow:0 8px 30px rgba(12,20,40,0.06);margin-top:14px}
    .drop{border:2px dashed #e6eefc;border-radius:10px;padding:22px;text-align:center;color:var(--muted);cursor:pointer;background:linear-gradient(180deg,rgba(11,95,255,0.02),transparent)}
    .controls{display:flex;flex-wrap:wrap;gap:12px;margin-top:12px;align-items:center}
    .control{display:flex;gap:8px;align-items:center}
    select,input[type=number],input[type=text]{padding:8px;border-radius:8px;border:1px solid #e6eefc;background:#fbfdff;font-size:13px}
    input[type=range]{vertical-align:middle}
    .files{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;margin-top:12px}
    .file-card{background:#fff;border-radius:10px;padding:10px;border:1px solid #f0f6ff;display:flex;flex-direction:column;gap:8px;box-shadow:0 8px 24px rgba(11,20,40,0.03)}
    .thumb{height:140px;object-fit:contain;background:#fbfdff;border-radius:6px;border:1px solid #eee}
    .row{display:flex;justify-content:space-between;align-items:center}
    button{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:600}
    .pill{background:#eef6ff;padding:6px 10px;border-radius:999px;color:var(--accent);font-weight:700}
    .progress{height:8px;background:#f1f5f9;border-radius:6px;overflow:hidden}
    .progress span{display:block;height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-2));width:0%}
    .footer{margin-top:18px;color:var(--muted);font-size:13px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}
    .small{font-size:13px}
    @media(max-width:700px){
      .controls{flex-direction:column;align-items:stretch}
      header{flex-direction:column;align-items:flex-start;gap:10px}
    }
    .compare{position:relative;overflow:hidden;border-radius:6px;border:1px solid #eee}
    .compare img{width:100%;display:block}
    .compare .after{position:absolute;left:0;top:0;height:100%;width:50%;overflow:hidden}
  </style>

  <!-- Libraries (deferred where possible) -->
  <script defer src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
  <!-- browser-image-compression will be lazy-loaded only when needed -->
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header>
      <div style="display:flex;align-items:center;gap:12px">
        <div class="logo" aria-hidden="true">AIT</div>
        <div>
          <h1>All Image Tools</h1>
          <div class="muted small">Free ‚Ä¢ Client-side ‚Ä¢ Privacy-first</div>
        </div>
      </div>
      <div style="margin-left:auto;display:flex;gap:10px;align-items:center">
        <a href="privacy.html" class="muted" style="text-decoration:none">Privacy</a>
        <a href="terms.html" class="muted" style="text-decoration:none">Terms</a>
        <a href="contact.html" class="muted" style="text-decoration:none">Contact</a>
        <button id="donateBtn" class="pill">Donate</button>
      </div>
    </header>

    <!-- Hero -->
    <section style="margin-top:14px">
      <div class="card" style="display:flex;gap:14px;align-items:center;flex-wrap:wrap">
        <div style="flex:1;min-width:220px">
          <h2 style="margin:0 0 8px 0">Compress, Convert, Resize & Edit ‚Äî all in your browser</h2>
          <p class="muted" style="margin:0 0 12px 0">Upload images, apply batch operations, and download ‚Äî files never leave your device.</p>
          <div style="display:flex;gap:8px">
            <button id="tryNow">Try Tools</button>
            <button id="scrollTools" style="background:transparent;color:var(--accent);border:1px solid rgba(11,95,255,0.12);border-radius:10px;padding:8px 12px">See Tools</button>
          </div>
        </div>
        <div style="width:220px">
          <div style="background:#fff;border-radius:10px;padding:12px;text-align:left;box-shadow:0 4px 18px rgba(11,20,40,0.04)">
            <div class="small muted">Files ready</div>
            <div id="fileCount" style="font-weight:700;font-size:18px;margin-top:6px">0 images</div>
            <div class="small muted" style="margin-top:8px">Drag & drop or choose files</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Tools Card (main) -->
    <div id="toolsCard" class="card" style="margin-top:18px">
      <div id="drop" class="drop">
        Drag & drop images here or
        <label style="color:var(--accent);text-decoration:underline;cursor:pointer">
          <input id="fileinput" type="file" accept="image/*" multiple style="display:none"> choose files
        </label>
        <div class="small muted" style="margin-top:8px">Supports JPEG, PNG, WebP. For very large PNGs use Auto preset.</div>
      </div>

      <!-- Controls -->
      <div class="controls" style="margin-top:12px">
        <div class="control">
          <label class="small muted">Method</label>
          <select id="method">
            <option value="auto">Auto (Smart)</option>
            <option value="quality">Quality (slider)</option>
            <option value="targetKB">Target size (KB/MB)</option>
            <option value="percentage">Percentage reduction</option>
            <option value="dimension">Max width/height</option>
          </select>
        </div>

        <div class="control" id="qualityControl" style="display:none">
          <label class="small muted">Quality</label>
          <input id="quality" type="range" min="10" max="100" value="85">
          <span id="qval" class="small muted">85</span>
        </div>

        <div class="control" id="kbControl" style="display:none">
          <label class="small muted">Target size</label>
          <input id="targetSize" type="number" min="0" step="0.01" placeholder="e.g., 200 or 0.5" style="width:110px">
          <select id="targetUnit" style="padding:8px;border-radius:8px;border:1px solid #e6eefc;background:#fbfdff">
            <option value="KB">KB</option><option value="MB">MB</option>
          </select>
        </div>

        <div class="control" id="percControl" style="display:none">
          <label class="small muted">Reduce %</label>
          <input id="percentage" type="number" min="1" max="99" placeholder="e.g., 60" style="width:110px">
        </div>

        <div class="control" id="dimControl" style="display:none">
          <label class="small muted">Max W / H</label>
          <input id="maxw" type="number" min="0" placeholder="W px" style="width:90px">
          <input id="maxh" type="number" min="0" placeholder="H px" style="width:90px">
        </div>

        <div class="control">
          <label class="small muted">Convert to</label>
          <select id="convert">
            <option value="keep">Keep</option>
            <option value="webp">WebP</option>
            <option value="jpeg">JPEG</option>
            <option value="png">PNG</option>
          </select>
        </div>

        <div class="control">
          <label class="small muted">Auto Preset</label>
          <select id="autoPreset">
            <option value="medium">Medium (recommended)</option>
            <option value="light">Light (quality-first)</option>
            <option value="extreme">Extreme (size-first)</option>
          </select>
        </div>

        <div style="margin-left:auto" class="control">
          <label class="small muted">Apply to all</label>
          <input id="applyAll" type="checkbox" checked>
        </div>
      </div>

      <!-- Action Buttons -->
      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:12px">
        <button id="compressSelected">Compress Selected</button>
        <button id="compressAll">Compress All</button>
        <button id="downloadZip">Download All (ZIP)</button>
        <button id="convertSelected" style="background:transparent;color:var(--accent);border:1px solid rgba(11,95,255,0.12);border-radius:10px;padding:8px 12px">Batch Convert</button>
        <button id="clearAll" style="background:#ccc;color:#111;border-radius:10px;padding:8px 12px">Clear</button>
      </div>

      <!-- Files Grid -->
      <div id="files" class="files"></div>

      <div class="footer">
        <div class="small muted">Tip: Use <strong>Auto</strong> for most images ‚Äî balances quality & size automatically.</div>
        <div style="display:flex;gap:12px;align-items:center">
          <a href="mailto:yuhazuha0@gmail.com" class="small muted" style="text-decoration:none">Contact: yuhazuha0@gmail.com</a>
          <a href="privacy.html" style="color:var(--accent);text-decoration:underline">Privacy Policy</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Crop modal (hidden until used) -->
  <div id="cropModal" style="display:none;position:fixed;left:0;top:0;right:0;bottom:0;background:rgba(0,0,0,0.6);z-index:9999;align-items:center;justify-content:center;padding:18px">
    <div style="background:#fff;padding:12px;border-radius:10px;max-width:900px;width:100%;max-height:90vh;overflow:auto">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong>Crop image</strong>
        <div><button id="closeCrop" style="background:transparent;border:1px solid #e6eefc;padding:6px 10px;border-radius:8px">Close</button></div>
      </div>
      <div style="margin-top:10px;display:flex;gap:12px;flex-wrap:wrap">
        <div style="flex:1;min-width:260px">
          <div id="cropCanvasWrap" style="border:1px solid #eee;padding:6px;border-radius:8px;display:flex;align-items:center;justify-content:center">
            <canvas id="cropCanvas" style="max-width:100%"></canvas>
          </div>
        </div>
        <div style="width:220px">
          <div class="small muted">Drag to select area. Use <strong>Apply Crop</strong> then download or continue editing.</div>
          <div style="margin-top:12px;display:flex;gap:8px">
            <button id="applyCrop" style="background:transparent;border:1px solid rgba(11,95,255,0.12);padding:8px 10px;border-radius:8px">Apply Crop</button>
            <button id="downloadCropped" style="background:#10b981;color:white;padding:8px 10px;border-radius:8px">Download</button>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
/* Main app script
   - lazy-loads heavy libs only when needed
   - concurrency queue to avoid device overload
   - all client-side, no back-end calls
*/

let imageCompressionLoaded = false;
async function ensureImageCompression(){
  if(imageCompressionLoaded) return;
  await new Promise((res,rej)=>{
    const s = document.createElement('script');
    s.src = 'https://unpkg.com/browser-image-compression@1.0.17/dist/browser-image-compression.js';
    s.onload = ()=>{ imageCompressionLoaded = true; res(); };
    s.onerror = ()=>{ rej(new Error('Failed to load compression lib')); };
    document.head.appendChild(s);
  });
}

// Utility & state
const fileinput = document.getElementById('fileinput');
const drop = document.getElementById('drop');
const filesEl = document.getElementById('files');
const methodEl = document.getElementById('method');
const qualityEl = document.getElementById('quality');
const qval = document.getElementById('qval');
const targetSizeEl = document.getElementById('targetSize');
const targetUnitEl = document.getElementById('targetUnit');
const percentageEl = document.getElementById('percentage');
const maxwEl = document.getElementById('maxw');
const maxhEl = document.getElementById('maxh');
const convertEl = document.getElementById('convert');
const autoPreset = document.getElementById('autoPreset');
const applyAllEl = document.getElementById('applyAll');

const compressSelectedBtn = document.getElementById('compressSelected');
const compressAllBtn = document.getElementById('compressAll');
const downloadZipBtn = document.getElementById('downloadZip');
const clearAllBtn = document.getElementById('clearAll');
const convertSelectedBtn = document.getElementById('convertSelected');

const cropModal = document.getElementById('cropModal');
const cropCanvas = document.getElementById('cropCanvas');
const closeCrop = document.getElementById('closeCrop');
const applyCrop = document.getElementById('applyCrop');
const downloadCropped = document.getElementById('downloadCropped');

let items = []; // {id,file,objectURL,preview,compressedBlob,afterURL,selected,progress,estimated}
let idCounter = 1;
let running = 0;
const CONCURRENCY = 2;
const queue = [];

function enqueue(task){ queue.push(task); runQueue(); }
function runQueue(){ if(running>=CONCURRENCY) return; const t = queue.shift(); if(!t) return; running++; t().finally(()=>{ running--; runQueue(); }); }

function humanBytes(n){
  if(!n && n !== 0) return '-';
  if(n===0) return '0 B';
  const units=['B','KB','MB','GB'];
  let i=Math.floor(Math.log(n)/Math.log(1024));
  if(i<0) i=0;
  return (n/Math.pow(1024,i)).toFixed(2)+' '+units[i];
}

function updateFileCount(){ document.getElementById('fileCount').textContent = items.length + (items.length===1?' image':' images'); }

function render(){
  filesEl.innerHTML='';
  items.forEach((it)=>{
    const div = document.createElement('div'); div.className='file-card'; div.dataset.id = it.id;
    const img = document.createElement('img'); img.className='thumb'; img.src = it.preview || it.objectURL; img.loading='lazy';
    const info = document.createElement('div');
    info.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center">
      <div><strong style="font-size:14px">${it.file.name}</strong><div class="muted small">${it.file.type} ‚Ä¢ ${humanBytes(it.file.size)}</div></div>
      <div class="flex"><label class="small muted">Sel</label><input type="checkbox" class="sel" ${it.selected?'checked':''}></div>
    </div>`;
    const prog = document.createElement('div'); prog.className='progress'; prog.style.marginTop='8px';
    const span = document.createElement('span'); span.style.width = (it.progress||0) + '%'; prog.appendChild(span);
    const afterLine = document.createElement('div'); afterLine.className='row small muted';
    const afterText = it.compressedBlob ? `${humanBytes(it.compressedBlob.size)} ‚Ä¢ saved ${((1 - (it.compressedBlob.size/it.file.size))*100).toFixed(1)}%` : 'Not compressed yet';
    afterLine.innerHTML = `<div>${afterText}</div><div>${it.estimated?'Est: '+humanBytes(it.estimated):''}</div>`;
    const actions = document.createElement('div'); actions.className='row';
    const left = document.createElement('div'); left.className='flex';
    const compBtn = document.createElement('button'); compBtn.textContent='Compress'; compBtn.onclick = ()=>compressSingleById(it.id);
    const dlBtn = document.createElement('button'); dlBtn.textContent='Download'; dlBtn.style.background='#10b981'; dlBtn.onclick = ()=>downloadSingle(it.id);
    const previewBtn = document.createElement('button'); previewBtn.textContent='Preview'; previewBtn.style.background='#6b7280'; previewBtn.onclick = ()=>openPreview(it);
    const removeBtn = document.createElement('button'); removeBtn.textContent='Remove'; removeBtn.style.background='#ef4444'; removeBtn.onclick = ()=>removeItemById(it.id);
    left.appendChild(compBtn); left.appendChild(dlBtn); left.appendChild(previewBtn);
    const right = document.createElement('div'); right.appendChild(removeBtn);
    actions.appendChild(left); actions.appendChild(right);
    div.appendChild(img); div.appendChild(info); div.appendChild(prog); div.appendChild(afterLine); div.appendChild(actions);
    filesEl.appendChild(div);
    div.querySelector('.sel').addEventListener('change', (e)=>{ it.selected = e.target.checked; });
  });
  updateFileCount();
}

// Add files
function addFiles(fileList){
  for(const f of fileList){
    if(!f.type.startsWith('image/')) continue;
    const id = idCounter++;
    const objectURL = URL.createObjectURL(f);
    items.push({id,file:f,objectURL,preview:null,compressedBlob:null,afterURL:null,selected:true,progress:0,estimated:null});
  }
  render();
  schedulePreviews();
}
drop.addEventListener('click', ()=>fileinput.click());
fileinput.addEventListener('change',(e)=>{ addFiles(e.target.files); fileinput.value=''; });
drop.addEventListener('dragover', e=>{ e.preventDefault(); drop.style.borderColor='#b5d1ff'; });
drop.addEventListener('dragleave', e=>{ drop.style.borderColor='#e6eefc'; });
drop.addEventListener('drop', e=>{ e.preventDefault(); drop.style.borderColor='#e6eefc'; addFiles(e.dataTransfer.files); });

/
